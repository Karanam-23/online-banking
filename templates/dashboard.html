{% extends "base.html" %}
{% block content %}
<div class="grid md:grid-cols-3 gap-6">
  <div class="col-span-2">
    <h3 class="text-xl font-semibold">Accounts</h3>
    <div class="grid grid-cols-2 gap-4 mt-4">
      {% for a in accounts %}
        <div class="p-4 rounded bg-white shadow">
          <div class="text-sm text-gray-500">Account</div>
          <div class="text-lg font-bold">{{ a.number }}</div>
          <div class="mt-2 text-2xl">₹ {{ "%.2f"|format(a.balance) }}</div>
        </div>
      {% endfor %}
    </div>

    <h3 class="text-xl font-semibold mt-6">Recent transactions</h3>
    <div class="mt-3 bg-white p-3 rounded shadow">
      {% for t in recent %}
        <div class="flex justify-between py-2 border-b">
          <div>
            <div class="font-semibold">{{ t.type }} → {{ t.note or '' }}</div>
            <div class="text-xs text-gray-500">{{ t.created_at }}</div>
          </div>
          <div class="text-right">
            <div class="{{ 'text-red-600' if t.amount<0 else 'text-green-600' }}">{{ t.amount }}</div>
          </div>
        </div>
      {% else %}
        <div class="p-6 text-gray-500">No transactions yet</div>
      {% endfor %}
    </div>
  </div>

  <div>
    <h3 class="text-xl font-semibold">Budget summary</h3>
    <div class="bg-white p-4 rounded shadow mt-4">
      <canvas id="budgetChart" width="300" height="300"></canvas>
    </div>
    <script>
      const ctx = document.getElementById('budgetChart');
      if (ctx) {
        new Chart(ctx, {
          type: 'pie',
          data: {
            labels: {{ categories.keys()|list|tojson }},
            datasets: [{ data: {{ categories.values()|list|tojson }} }]
          }
        });
      }
    </script>
  </div>
</div>
{% endblock %}
